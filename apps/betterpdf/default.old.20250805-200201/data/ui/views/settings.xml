<dashboard version="1.1" script="setuppage.js" hideEdit="true">
  <label>General setup</label>
  <row>
    <panel>
      <html>
        <div>
          <p>Licensed to: $cn$</p>
          <p>Valid until: $validtill$</p>
          <p>installed on: $installdate$</p>
          <p>Status: <b>$licensestatus$</b>
          </p>
          <p>Triallicense: $triallicense$</p>
          <p/>          
          <p>Chart dependencies (libcairo): <b>$libcairo$</b></p>
          </div>          
          </html>
      <html>
        <div id="install_license"/>
      </html>
    </panel>
    <panel>
      <html>
        <div>
          <p><h1>Onedrive business integration</h1></p>
          <p><b>ClientID:</b></p>
          <input value="$clientid$" type="text" id="clientid" title="Set the client id of the azure app"/>
          <!--  pattern="^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$" -->
          <p><b>Domain:</b></p>
          <input value="$domain$" type="text" id="domain" title="Set the domain name of the Azure tenant"/>
          <!--   pattern="^[0-9\.]*$" -->
          <p><b>Client secret:</b></p>
          <input value="********" type="password" id="password" name="password" aria-label="Set password" class="  " autocomplete="off" placeholder="New password"/>
          </div>
      </html>
      <html>
        <div id="update_onedrive_settings"/>
      </html>
    </panel>
  </row>
  <row>
  <panel>  
      <html>
          <div>
          <p><h1>Azure App settings for OneDrive:</h1></p>
          Create an app with the settings as seen below via your <a href="https://aka.ms/AppRegistrations/">Azure console</a>.<br/>
          <img src="/static/app/betterpdf/Splunk_OneDrive_AlertAction_Microsoft_Azure_App.png"/><br/>
          <img src="/static/app/betterpdf/Splunk_OneDrive_AlertAction_Microsoft_Azure_App_Permissions.png"/>
          </div>
      </html>
  </panel>
  </row>
  <row depends="$debug$">
    <panel>
      <title>Get license data from the rest endpoint</title>
      <table>
        <title>call license endpoint</title>
        <search>
          <done>
            <set token="licensestatus">$result.licensestatus$</set>
            <set token="cn">$result.cn$</set>
            <set token="validtill">$result.validtill$</set>
            <set token="installdate">$result.installdate$</set>
            <set token="triallicense">$result.triallicense$</set>
          </done>
          <query>|  rest /services/betterpdf license_status=true</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row depends="$debug$">
    <panel>
      <title>Get libcairo status from the rest endpoint</title>
      <table>
        <title>call license endpoint</title>
        <search>
          <done>
            <set token="libcairo">$result.libcairo$</set>
          </done>
          <query>|  rest /services/betterpdf test=true</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
</dashboard>